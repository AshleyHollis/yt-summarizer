# =============================================================================
# Preview Overlay Kustomization Template
# =============================================================================
# This is a template for the preview kustomization.yaml
# The script will load this and substitute variables
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

metadata:
  annotations:
    config.kubernetes.io/local-config: 'true'

namespace: preview-pr-__PR_NUMBER__

resources:
  - ../../base-preview
  - resource-quota.yaml
  - limit-range.yaml

images:
  - name: yt-summarizer-api
    newName: __ACR_SERVER__/yt-summarizer-api
    newTag: __IMAGE_TAG__
  - name: yt-summarizer-workers
    newName: __ACR_SERVER__/yt-summarizer-workers
    newTag: __IMAGE_TAG__

patches:
  - path: patches/externalsecret-db-patch.yaml
  - path: patches/externalsecret-openai-patch.yaml
  - path: patches/externalsecret-storage-patch.yaml
  - path: patches/secretstore-delete-patch.yaml
  - path: patches/configmap-patch.yaml
  - path: patches/ingress-delete-patch.yaml
  - path: patches/httproute-patch.yaml
  - path: patches/resources-patch.yaml
  - path: patches/replicas-patch.yaml
  - path: patches/migration-job-patch.yaml

