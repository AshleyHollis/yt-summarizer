# Gitleaks configuration
# https://github.com/gitleaks/gitleaks

title = "yt-summarizer gitleaks config"

[extend]
# Extend   default gitleaks config
useDefault = true

  # Allowlist rules for false positives
  paths = [
    '''infra/terraform/modules/.*/variables\.tf''',
    '''infra/terraform/environments/.*/variables\.tf''',
    '''infra/terraform/variables\.tf''',
    # Terraform example files
    '''.*\.tfvars\.example''',
    # CI/test docker compose (only contains dummy values)
    '''docker-compose\.ci\.yml''',
    # Test fixtures and test files (very broad)
    '''tests/''',
    '''test_''',
    '''_test\.py''',
    '''conftest\.py''',
    '''\.spec\.(ts|js)''',
    # Documentation (all markdown)
    '''\.md$''',
    # Development scripts with test credentials
    '''scripts/start-workers\.ps1''',
    # Kubernetes overlays (contain image tags, not secrets)
    '''k8s/overlays/.*/kustomization\.yaml''',
  ]

  # Regex patterns that are not secrets (matches in   secret value itself)
  regexes = [
    # Variable placeholder patterns
    '''var\.(sql_admin_password|admin_password|api_key)''',
    # Terraform variable references
    '''\$\{var\..*password.*\}''',
    # Example/placeholder values
    '''CHANGE_ME|REPLACE_ME|your-.*-here|example-.*''',
    # Documentation example passwords (explicit list)
    '''YourSecurePassword123!''',
    '''YourStrong@Passw0rd''',
    '''Your.*Passw.*''',
    # Test API keys (not real)
    '''sk-test-.*''',
    '''sk-fake-.*''',
    '''test-key.*''',
    '''test-api-key''',
    '''fake-''',
    # Azurite well-known development key (NOT production keys)
    '''Eby8vdM02xNOcqFlqUwJPLlmEtlCDXJ1OUzFT50uSRZ6IFsuFq2UVErCz4I6tq/K1SZFPTOtr/KBHBeksoGMGw==''',
    # ACR image references (not secrets, just image tags)
    '''acrytsummprd\.azurecr\.io/[a-z0-9-]+:pr-[0-9]+-[a-z0-9]+''',
  ]

  # Allowlist specific commits that contain false positives
  commits = [
    # CI-generated kustomization with ACR image tag (before regex was added)
    "3a5dc2e4fc59cbc0784001f7f59a386f7314a88f",
  ]
