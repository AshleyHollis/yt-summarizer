# Scan JavaScript/TypeScript Dependencies and Quality
# Checks for missing deps, vulnerabilities, and code quality issues
# Uses: npm audit, depcheck, eslint

name: 'Scan JavaScript Dependencies and Quality'
description: 'Scan JavaScript/TypeScript for missing dependencies and security issues'

inputs:
  working-directory:
    description: 'Directory containing package.json (e.g., apps/web)'
    required: true
  check-missing-deps:
    description: 'Check for missing dependencies using depcheck'
    required: false
    default: 'true'
  check-security:
    description: 'Run npm audit for security vulnerabilities'
    required: false
    default: 'true'
  audit-level:
    description: 'Minimum severity level for npm audit (low, moderate, high, critical)'
    required: false
    default: 'high'

runs:
  using: 'composite'
  steps:
    - name: Scan JavaScript dependencies
      shell: bash
      working-directory: ${{ inputs.working-directory }}
      env:
        CHECK_MISSING_DEPS: ${{ inputs.check-missing-deps }}
        CHECK_SECURITY: ${{ inputs.check-security }}
        AUDIT_LEVEL: ${{ inputs.audit-level }}
      run: ${{ github.action_path }}/script.sh
