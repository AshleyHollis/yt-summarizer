{
  "format_version": "1.2",
  "terraform_version": "1.5.7",
  "resource_changes": [
    {
      "address": "module.acr.azurerm_container_registry.acr",
      "type": "azurerm_container_registry",
      "name": "acr",
      "provider_name": "registry.terraform.io/hashicorp/azurerm",
      "change": {
        "actions": ["update"],
        "before": {
          "admin_enabled": false,
          "location": "australiaeast",
          "name": "ytsummarizerregistry",
          "resource_group_name": "yt-summarizer-rg",
          "sku": "Basic",
          "tags": {
            "environment": "production",
            "project": "yt-summarizer"
          }
        },
        "after": {
          "admin_enabled": false,
          "location": "australiaeast",
          "name": "ytsummarizerregistry",
          "resource_group_name": "yt-summarizer-rg",
          "sku": "Standard",
          "tags": {
            "environment": "production",
            "project": "yt-summarizer",
            "managed-by": "terraform"
          }
        },
        "after_unknown": {}
      }
    },
    {
      "address": "module.aks.azurerm_kubernetes_cluster.aks",
      "type": "azurerm_kubernetes_cluster",
      "name": "aks",
      "provider_name": "registry.terraform.io/hashicorp/azurerm",
      "change": {
        "actions": ["update"],
        "before": {
          "name": "yt-summarizer-aks",
          "location": "australiaeast",
          "resource_group_name": "yt-summarizer-rg",
          "dns_prefix": "ytsummarizer",
          "kubernetes_version": "1.28.5",
          "default_node_pool": {
            "name": "system",
            "node_count": 2,
            "vm_size": "Standard_B2s"
          }
        },
        "after": {
          "name": "yt-summarizer-aks",
          "location": "australiaeast",
          "resource_group_name": "yt-summarizer-rg",
          "dns_prefix": "ytsummarizer",
          "kubernetes_version": "1.29.0",
          "default_node_pool": {
            "name": "system",
            "node_count": 3,
            "vm_size": "Standard_B2s"
          }
        },
        "after_unknown": {}
      }
    },
    {
      "address": "module.github_oidc.azuread_application.github_actions",
      "type": "azuread_application",
      "name": "github_actions",
      "provider_name": "registry.terraform.io/hashicorp/azuread",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "display_name": "GitHub Actions OIDC",
          "description": "Service principal for GitHub Actions OIDC authentication",
          "sign_in_audience": "AzureADMyOrg"
        },
        "after_unknown": {
          "application_id": true,
          "object_id": true,
          "client_id": true
        }
      }
    },
    {
      "address": "module.github_oidc.azuread_application_federated_identity_credential.main",
      "type": "azuread_application_federated_identity_credential",
      "name": "main",
      "provider_name": "registry.terraform.io/hashicorp/azuread",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "display_name": "github-oidc-main",
          "description": "Federated credential for main branch",
          "issuer": "https://token.actions.githubusercontent.com",
          "subject": "repo:AshleyHollis/yt-summarizer:ref:refs/heads/main",
          "audiences": ["api://AzureADTokenExchange"]
        },
        "after_unknown": {
          "credential_id": true,
          "id": true
        }
      }
    },
    {
      "address": "module.github_oidc.azuread_application_federated_identity_credential.production",
      "type": "azuread_application_federated_identity_credential",
      "name": "production",
      "provider_name": "registry.terraform.io/hashicorp/azuread",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "display_name": "github-oidc-production",
          "description": "Federated credential for production environment",
          "issuer": "https://token.actions.githubusercontent.com",
          "subject": "repo:AshleyHollis/yt-summarizer:environment:production",
          "audiences": ["api://AzureADTokenExchange"]
        },
        "after_unknown": {
          "credential_id": true,
          "id": true
        }
      }
    },
    {
      "address": "module.github_oidc.azuread_application_federated_identity_credential.pull_request",
      "type": "azuread_application_federated_identity_credential",
      "name": "pull_request",
      "provider_name": "registry.terraform.io/hashicorp/azuread",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "display_name": "github-oidc-pull-request",
          "description": "Federated credential for pull requests",
          "issuer": "https://token.actions.githubusercontent.com",
          "subject": "repo:AshleyHollis/yt-summarizer:pull_request",
          "audiences": ["api://AzureADTokenExchange"]
        },
        "after_unknown": {
          "credential_id": true,
          "id": true
        }
      }
    },
    {
      "address": "module.github_oidc.azuread_service_principal.github_actions",
      "type": "azuread_service_principal",
      "name": "github_actions",
      "provider_name": "registry.terraform.io/hashicorp/azuread",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "description": "Service principal for GitHub Actions"
        },
        "after_unknown": {
          "application_id": true,
          "display_name": true,
          "object_id": true
        }
      }
    },
    {
      "address": "module.github_oidc.azurerm_role_assignment.acr_push[0]",
      "type": "azurerm_role_assignment",
      "name": "acr_push",
      "provider_name": "registry.terraform.io/hashicorp/azurerm",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "role_definition_name": "AcrPush",
          "scope": "/subscriptions/12345678-1234-1234-1234-123456789abc/resourceGroups/yt-summarizer-rg/providers/Microsoft.ContainerRegistry/registries/ytsummarizerregistry"
        },
        "after_unknown": {
          "id": true,
          "principal_id": true,
          "principal_type": true
        }
      }
    },
    {
      "address": "module.github_oidc.azurerm_role_assignment.contributor[0]",
      "type": "azurerm_role_assignment",
      "name": "contributor",
      "provider_name": "registry.terraform.io/hashicorp/azurerm",
      "change": {
        "actions": ["create"],
        "before": null,
        "after": {
          "role_definition_name": "Contributor",
          "scope": "/subscriptions/12345678-1234-1234-1234-123456789abc/resourceGroups/yt-summarizer-rg"
        },
        "after_unknown": {
          "id": true,
          "principal_id": true,
          "principal_type": true
        }
      }
    },
    {
      "address": "module.key_vault.azurerm_key_vault_secret.secrets[\"sql-connection-string\"]",
      "type": "azurerm_key_vault_secret",
      "name": "secrets",
      "provider_name": "registry.terraform.io/hashicorp/azurerm",
      "change": {
        "actions": ["update"],
        "before": {
          "name": "sql-connection-string",
          "content_type": "text/plain",
          "expiration_date": null
        },
        "after": {
          "name": "sql-connection-string",
          "content_type": "application/x-connection-string",
          "expiration_date": "2025-12-31T23:59:59Z"
        },
        "after_unknown": {
          "value": true,
          "version": true
        }
      }
    },
    {
      "address": "module.key_vault.azurerm_role_assignment.secrets_officer[0]",
      "type": "azurerm_role_assignment",
      "name": "secrets_officer",
      "provider_name": "registry.terraform.io/hashicorp/azurerm",
      "change": {
        "actions": ["delete"],
        "before": {
          "id": "/subscriptions/12345678-1234-1234-1234-123456789abc/providers/Microsoft.Authorization/roleAssignments/abcdef12-3456-7890-abcd-ef1234567890",
          "principal_id": "old-principal-id",
          "role_definition_name": "Key Vault Secrets Officer",
          "scope": "/subscriptions/12345678-1234-1234-1234-123456789abc/resourceGroups/yt-summarizer-rg/providers/Microsoft.KeyVault/vaults/ytsummarizerkv"
        },
        "after": null,
        "after_unknown": {}
      }
    },
    {
      "address": "module.sql.azurerm_mssql_database.database",
      "type": "azurerm_mssql_database",
      "name": "database",
      "provider_name": "registry.terraform.io/hashicorp/azurerm",
      "change": {
        "actions": ["update"],
        "before": {
          "name": "ytsummarizer",
          "sku_name": "Basic",
          "max_size_gb": 2,
          "zone_redundant": false,
          "storage_account_type": "Local"
        },
        "after": {
          "name": "ytsummarizer",
          "sku_name": "S0",
          "max_size_gb": 10,
          "zone_redundant": false,
          "storage_account_type": "Geo"
        },
        "after_unknown": {}
      }
    },
    {
      "address": "module.sql.azurerm_mssql_server.server",
      "type": "azurerm_mssql_server",
      "name": "server",
      "provider_name": "registry.terraform.io/hashicorp/azurerm",
      "change": {
        "actions": ["update"],
        "before": {
          "name": "ytsummarizer-sql",
          "version": "12.0",
          "minimum_tls_version": "1.0",
          "public_network_access_enabled": true
        },
        "after": {
          "name": "ytsummarizer-sql",
          "version": "12.0",
          "minimum_tls_version": "1.2",
          "public_network_access_enabled": false
        },
        "after_unknown": {}
      }
    },
    {
      "address": "module.storage.azurerm_storage_account.storage",
      "type": "azurerm_storage_account",
      "name": "storage",
      "provider_name": "registry.terraform.io/hashicorp/azurerm",
      "change": {
        "actions": ["update"],
        "before": {
          "name": "ytsummarizerstorage",
          "account_tier": "Standard",
          "account_replication_type": "LRS",
          "https_traffic_only_enabled": true
        },
        "after": {
          "name": "ytsummarizerstorage",
          "account_tier": "Standard",
          "account_replication_type": "GRS",
          "https_traffic_only_enabled": true
        },
        "after_unknown": {}
      }
    },
    {
      "address": "module.storage.azurerm_storage_container.containers[\"embeddings\"]",
      "type": "azurerm_storage_container",
      "name": "containers",
      "provider_name": "registry.terraform.io/hashicorp/azurerm",
      "change": {
        "actions": ["update"],
        "before": {
          "name": "embeddings",
          "container_access_type": "private"
        },
        "after": {
          "name": "embeddings",
          "container_access_type": "blob"
        },
        "after_unknown": {}
      }
    },
    {
      "address": "module.storage.azurerm_storage_container.containers[\"summaries\"]",
      "type": "azurerm_storage_container",
      "name": "containers",
      "provider_name": "registry.terraform.io/hashicorp/azurerm",
      "change": {
        "actions": ["update"],
        "before": {
          "name": "summaries",
          "container_access_type": "private"
        },
        "after": {
          "name": "summaries",
          "container_access_type": "blob"
        },
        "after_unknown": {}
      }
    },
    {
      "address": "module.storage.azurerm_storage_container.containers[\"transcripts\"]",
      "type": "azurerm_storage_container",
      "name": "containers",
      "provider_name": "registry.terraform.io/hashicorp/azurerm",
      "change": {
        "actions": ["update"],
        "before": {
          "name": "transcripts",
          "container_access_type": "private"
        },
        "after": {
          "name": "transcripts",
          "container_access_type": "blob"
        },
        "after_unknown": {}
      }
    },
    {
      "address": "module.storage.azurerm_storage_queue.queues[\"embed-queue\"]",
      "type": "azurerm_storage_queue",
      "name": "queues",
      "provider_name": "registry.terraform.io/hashicorp/azurerm",
      "change": {
        "actions": ["update"],
        "before": {
          "name": "embed-queue"
        },
        "after": {
          "name": "embed-queue",
          "metadata": {
            "purpose": "embedding-jobs"
          }
        },
        "after_unknown": {}
      }
    },
    {
      "address": "module.swa.azurerm_static_web_app.swa",
      "type": "azurerm_static_web_app",
      "name": "swa",
      "provider_name": "registry.terraform.io/hashicorp/azurerm",
      "change": {
        "actions": ["update"],
        "before": {
          "name": "yt-summarizer-swa",
          "sku_tier": "Free",
          "sku_size": "Free"
        },
        "after": {
          "name": "yt-summarizer-swa",
          "sku_tier": "Standard",
          "sku_size": "Standard"
        },
        "after_unknown": {}
      }
    },
    {
      "address": "module.cdn.azurerm_cdn_profile.profile",
      "type": "azurerm_cdn_profile",
      "name": "profile",
      "provider_name": "registry.terraform.io/hashicorp/azurerm",
      "change": {
        "actions": ["delete", "create"],
        "before": {
          "name": "yt-summarizer-cdn",
          "sku": "Standard_Verizon",
          "location": "australiaeast"
        },
        "after": {
          "name": "yt-summarizer-cdn",
          "sku": "Standard_Microsoft",
          "location": "australiaeast"
        },
        "after_unknown": {
          "id": true
        }
      }
    }
  ],
  "output_changes": {
    "github_oidc_application_id": {
      "actions": ["create"],
      "before": null,
      "after_unknown": true
    },
    "github_oidc_federated_credentials": {
      "actions": ["create"],
      "before": null,
      "after": {
        "main": "repo:AshleyHollis/yt-summarizer:ref:refs/heads/main",
        "production": "repo:AshleyHollis/yt-summarizer:environment:production",
        "pull_request": "repo:AshleyHollis/yt-summarizer:pull_request"
      }
    }
  }
}
