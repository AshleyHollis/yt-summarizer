@import "tailwindcss";

/* Enable class-based dark mode for next-themes */
@custom-variant dark (&:where(.dark, .dark *));

:root {
  --background: #ffffff;
  --foreground: #0f0f0f;
  --card-bg: #ffffff;
  --card-border: #e5e5e5;
  --muted: #606060;
  --accent: #cc0000;
  --accent-light: #fee2e2;
  /* YouTube-inspired interaction colors */
  --hover-bg: rgba(0, 0, 0, 0.05);
  --active-bg: rgba(0, 0, 0, 0.1);
  --focus-ring: rgba(204, 0, 0, 0.4);
}

/* Class-based dark mode for next-themes - YouTube dark mode colors */
.dark {
  --background: #0f0f0f;
  --foreground: #f1f1f1;
  --card-bg: #212121;
  --card-border: #3f3f3f;
  --muted: #aaaaaa;
  --accent: #ff0000;
  --accent-light: #3d0000;
  /* YouTube-inspired interaction colors for dark mode */
  --hover-bg: rgba(255, 255, 255, 0.1);
  --active-bg: rgba(255, 255, 255, 0.2);
  --focus-ring: rgba(255, 0, 0, 0.4);
}

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --font-sans: var(--font-geist-sans);
  --font-mono: var(--font-geist-mono);
}

body {
  background: var(--background);
  color: var(--foreground);
  font-family: Arial, Helvetica, sans-serif;
}

/* Smooth scrolling */
html {
  scroll-behavior: smooth;
}

/* ==================== Prose Typography Fixes ==================== */
/* Summary section headers - clear visual dividers for AI summaries */
.prose-summary h2 {
  font-size: 0.75rem;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.1em;
  color: rgb(220 38 38); /* red-600 */
  margin-top: 2rem;
  margin-bottom: 1rem;
  padding-bottom: 0.5rem;
  border-bottom: 1px solid rgb(229 231 235); /* gray-200 */
}

.prose-summary h2:first-child {
  margin-top: 0;
}

.dark .prose-summary h2 {
  color: rgb(248 113 113); /* red-400 */
  border-bottom-color: rgb(55 65 81); /* gray-700 */
}

/* Ensure bullet points and numbered lists are visible in prose content */
.prose ul {
  list-style-type: disc !important;
  padding-left: 1.5rem !important;
  margin-top: 0.75rem !important;
  margin-bottom: 0.75rem !important;
}

.prose ol {
  list-style-type: decimal !important;
  padding-left: 1.5rem !important;
  margin-top: 0.75rem !important;
  margin-bottom: 0.75rem !important;
}

.prose li {
  margin-top: 0.375rem !important;
  margin-bottom: 0.375rem !important;
  padding-left: 0.25rem !important;
}

.prose li::marker {
  color: var(--muted);
}

.dark .prose li::marker {
  color: var(--muted);
}

/* Nested lists */
.prose ul ul,
.prose ol ul {
  list-style-type: circle !important;
  margin-top: 0.25rem !important;
  margin-bottom: 0.25rem !important;
}

.prose ul ul ul,
.prose ol ul ul {
  list-style-type: square !important;
}

/* Custom selection color */
::selection {
  background-color: rgba(239, 68, 68, 0.25);
  color: inherit;
}

/* Better focus outlines - YouTube-inspired subtle red ring */
*:focus-visible {
  outline: 2px solid var(--focus-ring);
  outline-offset: 2px;
}

/* ==================== YouTube-like Interactive Box Styling ==================== */
/* Standard interactive box - used for buttons, cards, and clickable elements */
.yt-interactive-box {
  border: 1px solid var(--card-border);
  border-radius: 8px;
  background: var(--card-bg);
  transition: all 0.15s ease-out;
}

.yt-interactive-box:hover {
  background: var(--hover-bg);
  border-color: var(--accent);
}

.yt-interactive-box:active {
  background: var(--active-bg);
  transform: scale(0.98);
}

/* Pill button style - like YouTube's chip buttons */
.yt-pill-button {
  border: 1px solid var(--card-border);
  border-radius: 18px;
  padding: 8px 16px;
  background: var(--card-bg);
  font-size: 14px;
  font-weight: 500;
  transition: all 0.15s ease-out;
  cursor: pointer;
}

.yt-pill-button:hover {
  background: var(--hover-bg);
  border-color: var(--muted);
}

.yt-pill-button:active {
  background: var(--active-bg);
}

/* ==================== Dismissible/Clearable Badge Styling ==================== */
/* Badge with X button for dismissible items (scope chips, selections, tags) */
.yt-badge-dismissible {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 4px 8px;
  border-radius: 16px;
  background: var(--accent);
  color: white;
  font-size: 12px;
  font-weight: 500;
  transition: all 0.15s ease-out;
  cursor: pointer;
}

.yt-badge-dismissible:hover {
  filter: brightness(1.1);
}

.yt-badge-dismissible .yt-badge-x {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 2px;
  border-radius: 4px;
  transition: background 0.15s ease-out;
}

.yt-badge-dismissible:hover .yt-badge-x {
  background: rgba(255, 255, 255, 0.2);
}

/* Outlined version for lighter appearance */
.yt-badge-dismissible-outline {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 4px 10px;
  border: 2px solid var(--accent);
  border-radius: 16px;
  background: color-mix(in srgb, var(--accent) 10%, transparent);
  color: var(--accent);
  font-size: 12px;
  font-weight: 500;
  transition: all 0.15s ease-out;
  cursor: pointer;
}

.yt-badge-dismissible-outline:hover {
  background: color-mix(in srgb, var(--accent) 20%, transparent);
}

.yt-badge-dismissible-outline .yt-badge-x {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 2px;
  border-radius: 4px;
  transition: background 0.15s ease-out;
}

.yt-badge-dismissible-outline:hover .yt-badge-x {
  background: color-mix(in srgb, var(--accent) 30%, transparent);
}

/* ==================== Primary Action Button ==================== */
/* Red filled button for primary actions */
.yt-btn-primary {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  padding: 8px 16px;
  background: var(--accent);
  color: white;
  font-size: 14px;
  font-weight: 600;
  border-radius: 8px;
  border: none;
  cursor: pointer;
  transition: all 0.15s ease-out;
}

.yt-btn-primary:hover {
  filter: brightness(1.1);
  box-shadow: 0 4px 12px color-mix(in srgb, var(--accent) 40%, transparent);
}

.yt-btn-primary:active {
  transform: scale(0.98);
}

/* ==================== Text Link with Hover ==================== */
/* For inline links that should show red on hover */
.yt-link {
  color: var(--accent);
  text-decoration: none;
  transition: color 0.15s ease-out, text-decoration 0.15s ease-out;
}

.yt-link:hover {
  filter: brightness(1.15);
  text-decoration: underline;
}

/* ==================== Common Input Styling ==================== */
/* Standard text input - used for search boxes, form inputs, chat inputs */
.yt-input {
  border: 1px solid var(--card-border);
  border-radius: 8px;
  background: var(--card-bg);
  padding: 8px 12px;
  font-size: 14px;
  color: var(--foreground);
  transition: border-color 0.15s ease-out;
}

.yt-input::placeholder {
  color: var(--muted);
}

.yt-input:hover {
  border-color: var(--accent);
}

.yt-input:focus,
.yt-input:focus-within {
  border-color: var(--accent);
  outline: none;
}

/* Icon button with box - for toolbar buttons */
.yt-icon-button {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 36px;
  height: 36px;
  border: 1px solid transparent;
  border-radius: 8px;
  background: transparent;
  transition: all 0.15s ease-out;
  cursor: pointer;
}

.yt-icon-button:hover {
  background: var(--hover-bg);
  border-color: var(--card-border);
}

.yt-icon-button:active {
  background: var(--active-bg);
}

/* Skeleton loading animation */
@keyframes shimmer {
  0% {
    background-position: -200% 0;
  }
  100% {
    background-position: 200% 0;
  }
}

.skeleton {
  background: linear-gradient(
    90deg,
    #f0f0f0 25%,
    #e0e0e0 50%,
    #f0f0f0 75%
  );
  background-size: 200% 100%;
  animation: shimmer 1.5s ease-in-out infinite;
}

.dark .skeleton {
  background: linear-gradient(
    90deg,
    #2a2a2a 25%,
    #3a3a3a 50%,
    #2a2a2a 75%
  );
  background-size: 200% 100%;
}

/* ==================== CopilotKit Sidebar Styling ==================== */
/* YouTube-inspired dark mode chat interface */

/* Ensure chat sidebar and window appear above the navigation bar (which has z-40) */
.copilotKitSidebar {
  z-index: 50 !important;
  width: 380px !important;
  max-width: 90vw !important;
}

/* Initial/greeting message styling - the first assistant message */
.copilotKitMessagesContainer .copilotKitAssistantMessage:first-child .copilotKitMarkdown {
  background: var(--copilot-kit-secondary-color, #f2f2f2) !important;
  border: 1px solid var(--copilot-kit-separator-color, #e5e5e5) !important;
  border-radius: 8px !important;
  padding: 8px !important;
  margin: 0 !important;
}

.copilotKitMessagesContainer .copilotKitAssistantMessage:first-child .copilotKitMarkdown p {
  margin: 0 !important;
  padding: 0 !important;
  font-size: 14px !important;
  line-height: 1.5 !important;
  color: var(--copilot-kit-secondary-contrast-color, #0f0f0f) !important;
}

.copilotKitWindow {
  z-index: 50 !important;
  background: var(--copilot-kit-background-color, #ffffff) !important;
  border: 1px solid var(--copilot-kit-separator-color, #e5e5e5) !important;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.12), 0 2px 8px rgba(0, 0, 0, 0.08) !important;
  border-radius: 12px !important;
}

.dark .copilotKitWindow {
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5), 0 2px 8px rgba(0, 0, 0, 0.4) !important;
}

/* Chat header styling - YouTube-like */
.copilotKitHeader {
  background: var(--copilot-kit-secondary-color, #f2f2f2) !important;
  border-bottom: 1px solid var(--copilot-kit-separator-color, #e5e5e5) !important;
  border-radius: 12px 12px 0 0 !important;
  padding: 12px 16px !important;
}

/* Chat messages area */
.copilotKitMessages {
  background: var(--copilot-kit-background-color, #ffffff) !important;
  padding: 12px 12px !important;
}

/* Eliminate gaps between messages */
[class*="copilotKitMessages"] {
  gap: 6px !important;
}

[class*="copilotKitMessages"] > div {
  gap: 6px !important;
}

.copilotKitMessagesContainer {
  gap: 6px !important;
  padding-left: 0 !important;
  padding-right: 0 !important;
}

/* Hide empty divs that create gaps */
.copilotKitMessagesContainer > div:empty {
  display: none !important;
}

[class*="copilotKitMessages"] > div > div {
  gap: 2px !important;
  margin: 0 !important;
  padding: 0 !important;
}

/* Remove default message container padding */
[class*="copilotKit"] [class*="message"],
[class*="copilotKit"] [class*="Message"] {
  margin: 4px 0 !important;
  padding: 0 !important;
}

/* Chat input area - YouTube-like clean style */
.copilotKitInput,
.copilotKitInputContainer {
  background: var(--copilot-kit-background-color, #ffffff) !important;
  border-top: 1px solid var(--copilot-kit-separator-color, #e5e5e5) !important;
  padding: 12px 16px !important;
  border-radius: 0 0 12px 12px !important;
}

.copilotKitInputContainer form {
  display: flex !important;
  align-items: flex-end !important;
  gap: 10px !important;
}

.copilotKitInputContainer textarea,
.copilotKitInputContainer input {
  width: 100% !important;
  min-height: 40px !important;
  line-height: 1.5 !important;
  border-radius: 20px !important;
  padding: 10px 18px !important;
  background: var(--copilot-kit-secondary-color, #f2f2f2) !important;
  border: 1px solid var(--copilot-kit-separator-color, #e5e5e5) !important;
  font-size: 14px !important;
  transition: border-color 0.15s, box-shadow 0.15s !important;
}

.copilotKitInputContainer textarea:focus,
.copilotKitInputContainer input:focus {
  outline: none !important;
  border-color: var(--copilot-kit-primary-color, #cc0000) !important;
  box-shadow: 0 0 0 2px rgba(204, 0, 0, 0.15) !important;
}

/* User messages - clean box style aligned right with subtle border */
.copilotKitUserMessage,
[class*="copilotKitUserMessage" i],
[class*="copilotKit"] [class*="userMessage" i],
[class*="copilotKit"] [class*="user-message" i] {
  background: var(--copilot-kit-secondary-color, #f2f2f2) !important;
  border: 1px solid var(--copilot-kit-separator-color, #e5e5e5) !important;
  border-left: 3px solid var(--copilot-kit-primary-color, #cc0000) !important;
  border-radius: 10px !important;
  padding: 12px 16px !important;
  margin: 6px 0 !important;
  max-width: 90% !important;
  margin-left: auto !important;
  font-size: 14px !important;
  line-height: 1.6 !important;
  color: var(--copilot-kit-secondary-contrast-color, #0f0f0f) !important;
}

/* Also target any element with background gradient red that contains user text */
[class*="copilotKit"] div[style*="background"] {
  background: var(--copilot-kit-secondary-color, #f3f4f6) !important;
}

/* Assistant messages - clean container */
.copilotKitAssistantMessage {
  padding: 0 !important;
  margin: 6px 0 !important;
  width: 100% !important;
  max-width: 100% !important;
  align-self: stretch !important;
}

/* CopilotKit messages layout: stretch children to full width */
.copilotKitMessagesContainer {
  align-items: stretch !important;
}

/* Some CopilotKit builds use hashed classnames; ensure assistant bubbles can stretch */
[class*="copilotKitAssistantMessage" i] {
  width: 100% !important;
  max-width: 100% !important;
  align-self: stretch !important;
}

/* Tighten all message wrappers */
[class*="copilotKit"] [class*="wrapper"],
[class*="copilotKit"] [class*="Wrapper"],
[class*="copilotKit"] [class*="container"],
[class*="copilotKit"] [class*="Container"] {
  gap: 4px !important;
}

/* Send button - red with YouTube-like styling */
[class*="copilotKit"] button[type="submit"],
.copilotKitSendButton {
  background: var(--copilot-kit-primary-color, #cc0000) !important;
  border-radius: 50% !important;
  width: 40px !important;
  height: 40px !important;
  min-width: 40px !important;
  display: inline-flex !important;
  align-items: center !important;
  justify-content: center !important;
  box-shadow: 0 2px 6px rgba(204, 0, 0, 0.3) !important;
  transition: all 0.15s ease-out !important;
  border: none !important;
}

[class*="copilotKit"] button[type="submit"]:hover,
.copilotKitSendButton:hover {
  background: #b30000 !important;
  transform: scale(1.05) !important;
  box-shadow: 0 4px 12px rgba(204, 0, 0, 0.4) !important;
}

[class*="copilotKit"] button[type="submit"]:active,
.copilotKitSendButton:active {
  transform: scale(0.95) !important;
}

/* Links in chat - red */
.copilotKitMessage a {
  color: var(--copilot-kit-primary-color, #cc0000) !important;
}

/* Hide regenerate/action buttons */
.copilotKitMessageControls,
[class*="messageActions"],
[class*="MessageActions"],
.copilotKitMessageActions {
  display: none !important;
}

/* Hide Powered by CopilotKit text */
p.poweredBy {
  display: none !important;
}

/* Hide the inspector and version banner */
button[aria-label="Web Inspector"],
[class*="inspector"],
[class*="Inspector"],
[class*="devConsole"],
[class*="DevConsole"],
[class*="CopilotKit"] [role="note"] {
  display: none !important;
}

/* ==================== YouTube-style Icon Button Boxes ==================== */
/* Icon and button hover feedback with box borders */
.copilotKitWindow button:not([type="submit"]),
.copilotKitSidebar button:not([type="submit"]),
[class*="copilotKit"] button:not([type="submit"]) {
  transition: all 0.15s ease-out !important;
  border: 1px solid transparent !important;
  border-radius: 8px !important;
}

.copilotKitWindow button:not([type="submit"]):hover,
.copilotKitSidebar button:not([type="submit"]):hover,
[class*="copilotKit"] button:not([type="submit"]):hover {
  background-color: var(--copilot-kit-secondary-color, rgba(0, 0, 0, 0.05)) !important;
  border-color: var(--copilot-kit-separator-color, #e5e5e5) !important;
}

.copilotKitWindow button:not([type="submit"]):active,
.copilotKitSidebar button:not([type="submit"]):active,
[class*="copilotKit"] button:not([type="submit"]):active {
  transform: scale(0.95) !important;
}

.dark .copilotKitWindow button:not([type="submit"]):hover,
.dark .copilotKitSidebar button:not([type="submit"]):hover,
.dark [class*="copilotKit"] button:not([type="submit"]):hover {
  background-color: rgba(255, 255, 255, 0.1) !important;
  border-color: var(--copilot-kit-separator-color, #3f3f3f) !important;
}

/* Icon hover effects for SVG icons in chat */
.copilotKitWindow svg,
.copilotKitSidebar svg,
[class*="copilotKit"] svg {
  transition: all 0.15s ease-out !important;
}

.copilotKitWindow button:hover svg,
.copilotKitSidebar button:hover svg,
[class*="copilotKit"] button:hover svg {
  color: var(--copilot-kit-primary-color, #cc0000) !important;
}

/* Header close/minimize button hover with box */
.copilotKitHeader button:hover {
  background-color: rgba(204, 0, 0, 0.1) !important;
  border-radius: 8px !important;
  border: 1px solid rgba(204, 0, 0, 0.3) !important;
}

.dark .copilotKitHeader button:hover {
  background-color: rgba(255, 0, 0, 0.15) !important;
  border-color: rgba(255, 0, 0, 0.3) !important;
}

/* ==================== Hide Duplicate Text Content ==================== */
/**
 * CRITICAL: Prevents duplicate answer text in CopilotKit messages.
 * 
 * PROBLEM: CopilotKit renders BOTH:
 *   1. The custom tool UI (via useRenderToolCall) - our rich video cards, answers, etc.
 *   2. A plain markdown text (copilotKitMarkdown) with the raw answer
 * 
 * This causes the same answer to appear twice in the chat - once nicely formatted
 * in our custom component, and once as plain text below it.
 * 
 * SOLUTION: Hide copilotKitMarkdown for all assistant messages EXCEPT the first one
 * (which is the greeting message that doesn't have a tool render).
 * 
 * WHY :first-child exception: The initial greeting ("Hello! I'm your AI assistant...")
 * is a regular text message without any tool call, so it needs the markdown to show.
 * 
 * @see apps/web/src/hooks/useBackendToolRenderers.tsx - registers tool renderers
 * @see apps/web/src/components/copilot/CopilotMessage.tsx - our rich answer UI
 */

/* Hide the copilotKitMarkdown div for all assistant messages (tool renders handle display) */
.copilotKitAssistantMessage .copilotKitMarkdown,
[class*="copilotKitAssistantMessage"] .copilotKitMarkdown,
[class*="copilotKitAssistantMessage"] [class*="copilotKitMarkdown"] {
  display: none !important;
}

/* Exception: Keep the first assistant message (greeting) visible - it has no tool render */
.copilotKitMessagesContainer .copilotKitAssistantMessage:first-child .copilotKitMarkdown,
[class*="copilotKitMessages"] [class*="copilotKitAssistantMessage"]:first-child [class*="copilotKitMarkdown"] {
  display: block !important;
}

/* ==================== Hide Duplicate Loading Indicators ==================== */
/**
 * CRITICAL: Prevents duplicate loading indicators in CopilotKit.
 * 
 * PROBLEM: CopilotKit shows its own "typing" dots (copilotKitActivityDot) while
 * our custom tool render shows a "Searching videos..." spinner. This causes
 * two loading indicators to appear simultaneously.
 * 
 * SOLUTION: Hide CopilotKit's default loading indicators entirely.
 * Our tool render handles the loading state with a custom spinner.
 * 
 * @see apps/web/src/hooks/useBackendToolRenderers.tsx - custom loading spinner (ToolLoadingState)
 */
.copilotKitTypingIndicator,
.copilotKitActivityDot,
[class*="TypingIndicator"],
[class*="typingIndicator"],
[class*="ActivityDot"],
[class*="activityDot"] {
  display: none !important;
}