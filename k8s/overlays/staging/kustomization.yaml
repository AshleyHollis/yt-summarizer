# =============================================================================
# Staging Overlay Kustomization
# =============================================================================
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: yt-summarizer

resources:
  - ../../base

# Image tag will be updated by CI/CD pipeline
images:
  - name: ACR_LOGIN_SERVER/yt-summarizer-api
    newName: acrytsummstg.azurecr.io/yt-summarizer-api
    newTag: latest
  - name: ACR_LOGIN_SERVER/yt-summarizer-workers
    newName: acrytsummstg.azurecr.io/yt-summarizer-workers
    newTag: latest

# Staging-specific patches
patches:
  - path: patches/configmap-patch.yaml
  - path: patches/ingress-patch.yaml
  - path: patches/resources-patch.yaml

labels:
  - pairs:
      environment: staging

commonAnnotations:
  deployment.kubernetes.io/environment: staging
