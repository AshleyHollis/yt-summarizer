# =============================================================================
# Production Overlay Kustomization
# =============================================================================
# Single production environment - auto-synced by Argo CD on merge to main
# Last updated: 2026-01-18T05:38:41Z

apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: yt-summarizer
resources:
  - ../../base
  - priority-class.yaml
patches:
  - path: patches/configmap-patch.yaml
  - path: patches/httproute-patch.yaml
  - target:
      group: apps
      version: v1
      kind: Deployment
      name: api
    patch: |
      apiVersion: apps/v1
      kind: Deployment
      metadata:
        name: api
      spec:
        template:
          spec:
            containers:
              - name: api
                resources:
                  requests:
                    cpu: 25m
                    memory: 128Mi
                  limits:
                    cpu: 500m
                    memory: 512Mi
  - target:
      group: apps
      version: v1
      kind: Deployment
      name: transcribe-worker
    patch: |
      apiVersion: apps/v1
      kind: Deployment
      metadata:
        name: transcribe-worker
      spec:
        template:
          spec:
            containers:
              - name: worker
                  resources:
                    requests:
                      cpu: 25m
                      memory: 128Mi
                    limits:
                      cpu: 500m
                      memory: 512Mi
  - target:
      group: apps
      version: v1
      kind: Deployment
      name: summarize-worker
    patch: |
      apiVersion: apps/v1
      kind: Deployment
      metadata:
        name: summarize-worker
      spec:
        template:
          spec:
            containers:
              - name: worker
                resources:
                  requests:
                    cpu: 25m
                    memory: 128Mi
                  limits:
                    cpu: 500m
                    memory: 512Mi
  - target:
      group: apps
      version: v1
      kind: Deployment
      name: embed-worker
    patch: |
      apiVersion: apps/v1
      kind: Deployment
      metadata:
        name: embed-worker
      spec:
        template:
          spec:
            containers:
              - name: worker
                resources:
                  requests:
                    cpu: 25m
                    memory: 128Mi
                  limits:
                    cpu: 500m
                    memory: 512Mi
  - target:
      group: apps
      version: v1
      kind: Deployment
      name: relationships-worker
    patch: |
      apiVersion: apps/v1
      kind: Deployment
      metadata:
        name: relationships-worker
      spec:
        template:
          spec:
            containers:
              - name: worker
                resources:
                  requests:
                    cpu: 25m
                    memory: 128Mi
                  limits:
                    cpu: 500m
                    memory: 512Mi
  - path: patches/priority-class-patch.yaml
images:
  - 
    name: yt-summarizer-api
    newName: acrytsummprd.azurecr.io/yt-summarizer-api
    newTag: sha-50f9bf5
  - 
    name: yt-summarizer-workers
    newName: acrytsummprd.azurecr.io/yt-summarizer-workers
    newTag: sha-50f9bf5
labels:
- pairs:
    environment: "production"
    app.kubernetes.io/part-of: "yt-summarizer"
commonAnnotations:
  deployment.kubernetes.io/environment: production
