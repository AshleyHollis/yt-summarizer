# =============================================================================
# Production Overlay Kustomization
# =============================================================================
# Single production environment - auto-synced by Argo CD on merge to main
# Last updated: 2026-01-12T04:10:00Z

apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
namespace: yt-summarizer
resources:
- ../../base
- priority-class.yaml
images:
- name: yt-summarizer-api
  newName: acrytsummprd.azurecr.io/yt-summarizer-api
  newTag: sha-07bbad4
- name: yt-summarizer-workers
  newName: acrytsummprd.azurecr.io/yt-summarizer-workers
  newTag: sha-07bbad4
patches:
- path: patches/configmap-patch.yaml
- path: patches/ingress-delete-patch.yaml
- path: patches/httproute-patch.yaml
- target:
    group: apps
    version: v1
    kind: Deployment
    name: api
    namespace: yt-summarizer
  patch: "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: api\nspec:\n  template:\n    spec:\n      containers:\n        - name: api\n          resources:\n            requests:\n              cpu: 25m\n              memory: 128Mi\n            limits:\n              cpu: 500m\n              memory: 512Mi"
- target:
    group: apps
    version: v1
    kind: Deployment
    name: transcribe-worker
    namespace: yt-summarizer
  patch: "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: transcribe-worker\nspec:\n  template:\n    spec:\n      containers:\n        - name: worker\n          resources:\n            requests:\n              cpu: 25m\n              memory: 128Mi\n            limits:\n              cpu: 500m\n              memory: 512Mi"
- target:
    group: apps
    version: v1
    kind: Deployment
    name: summarize-worker
    namespace: yt-summarizer
  patch: "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: summarize-worker\nspec:\n  template:\n    spec:\n      containers:\n        - name: worker\n          resources:\n            requests:\n              cpu: 25m\n              memory: 128Mi\n            limits:\n              cpu: 500m\n              memory: 512Mi"
- target:
    group: apps
    version: v1
    kind: Deployment
    name: embed-worker
    namespace: yt-summarizer
  patch: "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: embed-worker\nspec:\n  template:\n    spec:\n      containers:\n        - name: worker\n          resources:\n            requests:\n              cpu: 25m\n              memory: 128Mi\n            limits:\n              cpu: 500m\n              memory: 512Mi"
- target:
    group: apps
    version: v1
    kind: Deployment
    name: relationships-worker
    namespace: yt-summarizer
  patch: "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: relationships-worker\nspec:\n  template:\n    spec:\n      containers:\n        - name: worker\n          resources:\n            requests:\n              cpu: 25m\n              memory: 128Mi\n            limits:\n              cpu: 500m\n              memory: 512Mi"
- target:
    group: apps
    version: v1
    kind: Deployment
    name: api
    namespace: yt-summarizer
  patch: "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: api\nspec:\n  template:\n    spec:\n      priorityClassName: production-critical"
- target:
    group: apps
    version: v1
    kind: Deployment
    name: transcribe-worker
    namespace: yt-summarizer
  patch: "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: transcribe-worker\nspec:\n  template:\n    spec:\n      priorityClassName: production-critical"
- target:
    group: apps
    version: v1
    kind: Deployment
    name: summarize-worker
    namespace: yt-summarizer
  patch: "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: summarize-worker\nspec:\n  template:\n    spec:\n      priorityClassName: production-critical"
- target:
    group: apps
    version: v1
    kind: Deployment
    name: embed-worker
    namespace: yt-summarizer
  patch: "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: embed-worker\nspec:\n  template:\n    spec:\n      priorityClassName: production-critical"
- target:
    group: apps
    version: v1
    kind: Deployment
    name: relationships-worker
    namespace: yt-summarizer
  patch: "apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: relationships-worker\nspec:\n  template:\n    spec:\n      priorityClassName: production-critical"
labels:
- pairs:
    environment: production
    app.kubernetes.io/part-of: yt-summarizer
commonAnnotations:
  deployment.kubernetes.io/environment: production
